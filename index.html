<!DOCTYPE html>
<html lang="pt-PT">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Gestor de Clubes Escolares</title>
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; background: #f7faff; margin: 0; }
        .container { max-width: 760px; margin: 2em auto; background: #fff; padding: 2em; border-radius: 10px; box-shadow: 0 2px 12px #95a1b326;}
        h1, h2 { color: #1d375c; }
        table { width: 100%; border-collapse: collapse; margin-top: 1em; font-size: 1em;}
        th, td { border: 1px solid #ccd; padding: 0.6em; text-align: left; }
        th { background: #eaeffa; }
        input, select { width: 100%; margin: .3em 0 1em 0; padding: .5em; border: 1px solid #b5bfde; border-radius: 4px;}
        label { font-weight: 600; display:block;}
        button { background: #1d375c; color: #fff; border: none; border-radius: 4px; padding: .5em 1em; font-weight: 600; cursor: pointer;}
        button:hover { background: #325fa6;}
        .secao { margin-bottom: 3em;}
        .mini { font-size: .96em; color: #444; }
        .hidden { display:none;}
        .topbar { margin-bottom: 2em; }
        @media (max-width: 600px) {
          .container { padding: .7em; }
          table, thead, tbody, th, td, tr { font-size: .95em; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="topbar">
            <h1>Gestor de Clubes Escolares</h1>
            <div class="mini">Os dados são guardados no navegador deste dispositivo.<br>Podes criar vários clubes, membros e atividades.</div>
        </div>

        <!-- Secção Criação de Clubes -->
        <div class="secao">
            <h2>Criar novo clube</h2>
            <form id="formClube">
                <label>Nome do clube:<input type="text" id="nomeClube" required></label>
                <label>Coordenador:<input type="text" id="coordenadorClube" required></label>
                <button type="submit">Adicionar clube</button>
            </form>
        </div>

        <!-- Lista Clubes Existentes -->
        <div class="secao">
            <h2>Clubes registados</h2>
            <table id="tabelaClubes">
                <thead>
                    <tr>
                        <th>Nome</th>
                        <th>Coordenador</th>
                        <th>Membros</th>
                        <th>Atividades</th>
                        <th>Ações</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>

        <!-- Secção Gestão de Membros -->
        <div class="secao hidden" id="secMembros">
            <h2>Membros de <span id="nomeClubeMembros"></span></h2>
            <form id="formMembro">
                <label>Nome do membro:<input type="text" id="nomeMembro" required></label>
                <label>Função:<input type="text" id="funcaoMembro"></label>
                <button type="submit">Adicionar membro</button>
            </form>
            <table id="tabelaMembros">
                <thead>
                    <tr><th>Nome</th><th>Função</th><th></th></tr>
                </thead>
                <tbody></tbody>
            </table>
            <button onclick="fecharMembros()">Fechar membros</button>
        </div>

        <!-- Secção Gestão de Atividades -->
        <div class="secao hidden" id="secAtividades">
            <h2>Atividades do clube <span id="nomeClubeAtividades"></span></h2>
            <form id="formAtividade">
                <label>Título:<input type="text" id="tituloAtividade" required></label>
                <label>Data:<input type="date" id="dataAtividade"></label>
                <label>Descrição:<input type="text" id="descricaoAtividade"></label>
                <button type="submit">Adicionar atividade</button>
            </form>
            <table id="tabelaAtividades">
                <thead>
                    <tr><th>Título</th><th>Data</th><th>Descrição</th><th></th></tr>
                </thead>
                <tbody></tbody>
            </table>
            <button onclick="fecharAtividades()">Fechar atividades</button>
        </div>
    </div>
<script>
let clubes = JSON.parse(localStorage.getItem('clubes')||'[]');
let clubeAtivo = null;
let secMembros = document.getElementById('secMembros');
let secAtividades = document.getElementById('secAtividades');

function guardar() { localStorage.setItem('clubes', JSON.stringify(clubes)); }

function atualizarTabelaClubes() {
    const tbody = document.querySelector('#tabelaClubes tbody');
    tbody.innerHTML = clubes.map((clube, i) => `<tr>
        <td>${clube.nome}</td>
        <td>${clube.coordenador}</td>
        <td>
            <button onclick="abrirMembros(${i})">${clube.membros?.length||0}</button>
        </td>
        <td>
            <button onclick="abrirAtividades(${i})">${clube.atividades?.length||0}</button>
        </td>
        <td>
            <button onclick="apagarClube(${i})">Apagar</button>
        </td>
    </tr>`).join('');
}

document.getElementById('formClube').onsubmit = function(e){
    e.preventDefault();
    let nome = document.getElementById('nomeClube').value.trim();
    let coord = document.getElementById('coordenadorClube').value.trim();
    if(!nome || !coord) return alert('Nome e coordenador obrigatórios!');
    clubes.push({nome, coordenador: coord, membros:[], atividades:[]});
    guardar();
    atualizarTabelaClubes();
    this.reset();
};
function apagarClube(i){
    if(confirm("Apagar este clube?")) {
        clubes.splice(i,1);
        guardar();
        atualizarTabelaClubes();
        fecharMembros();
        fecharAtividades();
    }
}

// ------- Gestão de Membros -------
function abrirMembros(indice){
    clubeAtivo = indice;
    document.getElementById('nomeClubeMembros').textContent = clubes[clubeAtivo].nome;
